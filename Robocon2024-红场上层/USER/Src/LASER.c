/*
*********************************************************************************************************
*                                             INCLUDE FILES
*********************************************************************************************************
*/
#include "LASER.h"

/*
*********************************************************************************************************
*                                               CONSTANTS
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                            	变量定义
*********************************************************************************************************
*/
uint8_t LASER_RX_BUF[4][LASER_BUFFER_SIZE];
float LASER_distance[4];

/*
*********************************************************************************************************
*                                               函数实现
*********************************************************************************************************
*/
/**
 * @brief  激光数据解析
 * @param  laser_num: 激光编号
 * @retval None
 * @note
 * 
 * 
 */
void LASER_Analyze(uint8_t laser_num)
{
    uint8_t i;
    uint8_t check_sum=0;
    int8_t distance[6];
    for(i=0;i<LASER_FRAME_SIZE-1;i++)
    {
        check_sum+=LASER_RX_BUF[laser_num][i];
    }
    if(LASER_RX_BUF[laser_num][LASER_FRAME_SIZE-1]==(check_sum=(~check_sum+1)))
    {
        for(i=0;i<6;i++)
        {
            distance[i]=LASER_RX_BUF[laser_num][i+4]-'0';
        }
        LASER_distance[laser_num]=10*distance[0]+distance[1]+0.1*distance[3]+0.01*distance[4]+0.001*distance[5];
    }
}